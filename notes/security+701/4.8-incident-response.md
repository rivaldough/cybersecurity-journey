# 4.8 – Incident Response

### Incident Response Process
1. **Preparation**
   - Policies, playbooks, contacts, comms plan, tooling (SIEM, EDR, forensics kits), backups, legal engagement.
   - Access control baselines, logging standards, tabletop cadence.

2. **Detection**
   - Identify potential incidents via alerts, user reports, anomaly detection, threat intel.
   - Triage: categorize (malware, BEC, DDoS, insider), assign severity/priority.

3. **Analysis**
   - Scope affected hosts, accounts, data, timelines.
   - Validate IoCs, correlate logs, build an attack narrative (TTPs, MITRE mapping).

4. **Containment**
   - **Short-term:** isolate hosts, disable accounts, block indicators, segment network.
   - **Long-term:** temporary compensating controls that allow business continuity (e.g., proxy rules, hardening).

5. **Eradication**
   - Remove malware/persistence, rotate creds/keys, close initial access vectors, patch vulnerabilities.

6. **Recovery**
   - Restore from clean backups, reimage as needed, validate integrity, increase monitoring, phased return to production.

7. **Lessons Learned**
   - Post-incident review (what happened, what worked/failed, gaps).
   - Update playbooks/controls, add detections, train staff, track corrective actions.

---

### Training
- Role-based IR training for SOC, IT, legal, PR, management.
- Escalation paths, decision authority, communication etiquette (internal/external).

### Testing
- **Tabletop exercise:** discussion-based scenario walk-through; validates process/roles.
- **Simulation:** live, controlled technical exercise (purple team, attack simulations); validates tooling/runbooks.

### Root Cause Analysis (RCA)
- Identify initiating cause(s) and systemic contributors.
- Document fix list (technical, process, human factors) with owners and deadlines.

### Threat Hunting
- Proactive hypotheses using TTPs, baselines, intel.
- Hunt sources: endpoint telemetry, auth logs, DNS, proxy, NetFlow/pcap, cloud audit logs.
- Convert findings into detections and hardening tasks.

### Digital Forensics
- **Legal hold:** instruct preservation of potentially relevant data.
- **Chain of custody:** evidence handling log (who/what/when/where/why), tamper-evident storage.
- **Acquisition:** forensically sound imaging (disk, memory), log collection, cloud exports; verify with hashes.
- **Preservation:** maintain originals read-only; analyze verified copies.
- **Reporting:** clear, repeatable methods, timelines, findings, and impact for technical/legal audiences.
- **E-discovery:** identify, collect, review, and produce electronically stored information (ESI) per legal requirements.

---

## Flashcards

**Q: What are the seven phases of the incident response process?**  
A: Preparation, Detection, Analysis, Containment, Eradication, Recovery, Lessons Learned.

**Q: What is the goal of the Preparation phase?**  
A: Establish policies, playbooks, tooling, logging, and communication plans to enable an effective response.

**Q: How does Detection differ from Analysis?**  
A: Detection identifies potential incidents; Analysis confirms scope, severity, and builds the attack timeline.

**Q: What’s the difference between short-term and long-term containment?**  
A: Short-term immediately stops spread (isolate hosts, block IoCs); long-term enables business continuity with temporary controls.

**Q: What activities belong in Eradication?**  
A: Remove malware/persistence, close initial access, patch vulnerabilities, rotate credentials/keys.

**Q: What are key steps in Recovery?**  
A: Restore clean systems, validate integrity, monitor closely, and return to production in phases.

**Q: What should a Lessons Learned meeting produce?**  
A: Documented gaps, corrective actions, updates to playbooks/detections, and assigned owners/dates.

**Q: Why conduct IR training?**  
A: To ensure roles, escalation paths, and communications are understood before an incident.

**Q: Tabletop vs Simulation — what’s the difference?**  
A: Tabletop is discussion-based; Simulation is a live technical exercise validating tools and runbooks.

**Q: What is Root Cause Analysis (RCA)?**  
A: A structured process to determine initiating causes and systemic contributors, leading to preventive fixes.

**Q: Define threat hunting.**  
A: Proactive searches for unknown threats using hypotheses, TTPs, baselines, and telemetry.

**Q: Name three high-value data sources for hunts.**  
A: Endpoint telemetry (EDR), authentication logs, DNS/proxy logs (others: NetFlow/pcap, cloud audit).

**Q: What is a legal hold?**  
A: A directive to preserve potentially relevant data for investigations or litigation.

**Q: What is chain of custody and why is it critical?**  
A: A documented trail of evidence handling that preserves admissibility and integrity.

**Q: What makes an acquisition forensically sound?**  
A: Verified imaging with hashing, preserving originals read-only, and analyzing validated copies.

**Q: What is the purpose of preservation in forensics?**  
A: Maintain original data integrity to prevent alteration and ensure evidentiary value.

**Q: What should a DFIR report include?**  
A: Methods, timelines, findings, impact, evidence references, and clear, reproducible steps.

**Q: What is e-discovery?**  
A: The legal process to identify, collect, review, and produce electronic evidence (ESI).

**Q: Give one example of converting hunt findings into operational improvements.**  
A: Turn a discovered behavior into a SIEM detection rule and add a hardening control to prevent it.

**Q: Name two common containment actions for credential compromise.**  
A: Disable affected accounts and force credential/key rotation.
